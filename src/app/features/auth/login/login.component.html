<a href="#main-content" class="skip-link">Saltar al contenido principal</a>
<div class="login-container" role="main" id="main-content">
  <div class="login-card">
    <div class="login-logo">
      <div class="logo-icon">
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="8" y="14" width="32" height="4" rx="2" fill="currentColor" opacity="0.3"/>
          <rect x="8" y="22" width="24" height="4" rx="2" fill="currentColor" opacity="0.5"/>
          <rect x="8" y="30" width="28" height="4" rx="2" fill="currentColor"/>
          <circle cx="38" cy="16" r="3" fill="#2563eb"/>
        </svg>
      </div>
      <h2 class="logo-text">TaskApp</h2>
    </div>
    
    <header class="login-header">
      <h1>{{ isRegisterMode ? 'Crear Cuenta' : 'Iniciar Sesión' }}</h1>
      <p>{{ isRegisterMode ? 'Regístrate para gestionar tus tareas' : 'Bienvenido de nuevo' }}</p>
    </header>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" [attr.aria-label]="isRegisterMode ? 'Formulario de registro' : 'Formulario de inicio de sesión'">
      <div class="form-group">
        <label for="username">{{ isRegisterMode ? 'Nombre de Usuario' : 'Usuario o Email' }}</label>
        <input
          type="text"
          id="username"
          formControlName="username"
          placeholder="{{ isRegisterMode ? 'Ingresa tu usuario' : 'Usuario o email' }}"
          [class.error]="loginForm.get('username')?.invalid && loginForm.get('username')?.touched"
          [attr.aria-invalid]="loginForm.get('username')?.invalid && loginForm.get('username')?.touched"
          [attr.aria-describedby]="loginForm.get('username')?.invalid && loginForm.get('username')?.touched ? 'username-error' : null"
        />
        <span class="error-message" id="username-error" role="alert" *ngIf="loginForm.get('username')?.invalid && loginForm.get('username')?.touched">
          {{ usernameError }}
        </span>
      </div>

      <div class="form-group" *ngIf="isRegisterMode">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          formControlName="email"
          placeholder="tu@email.com"
          [class.error]="loginForm.get('email')?.invalid && loginForm.get('email')?.touched"
          [attr.aria-invalid]="loginForm.get('email')?.invalid && loginForm.get('email')?.touched"
          [attr.aria-describedby]="loginForm.get('email')?.invalid && loginForm.get('email')?.touched ? 'email-error' : null"
        />
        <span class="error-message" id="email-error" role="alert" *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched">
          {{ emailError }}
        </span>
      </div>

      <div class="form-group">
        <label for="password">Contraseña</label>
        <input
          type="password"
          id="password"
          formControlName="password"
          placeholder="••••••••"
          [class.error]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched"
          [attr.aria-invalid]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched"
          [attr.aria-describedby]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched ? 'password-error' : null"
        />
        <span class="error-message" id="password-error" role="alert" *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched">
          {{ passwordError }}
        </span>
      </div>

      <button 
        type="submit" 
        class="btn-submit" 
        [disabled]="(loading$ | async) || loginForm.invalid"
        [attr.aria-busy]="loading$ | async">
        <span *ngIf="!(loading$ | async)">{{ isRegisterMode ? 'Registrarse' : 'Iniciar Sesión' }}</span>
        <span *ngIf="loading$ | async" class="spinner" role="status" aria-live="polite">Cargando...</span>
      </button>
    </form>

    <div class="login-footer">
      <p>
        {{ isRegisterMode ? '¿Ya tienes cuenta?' : '¿No tienes cuenta?' }}
        <a href="#" (click)="toggleMode(); $event.preventDefault()" aria-label="{{ isRegisterMode ? 'Cambiar a inicio de sesión' : 'Cambiar a registro' }}">
          {{ isRegisterMode ? 'Inicia sesión' : 'Regístrate' }}
        </a>
      </p>
    </div>
    <div role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  </div>
</div>
